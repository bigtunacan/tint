<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>Phaser - Making your first game, part 2</title>
        <script type="text/javascript" src="lib/phaser.min.js"></script>
        <style type="text/css">
            body{
                margin: 0;
            }
        </style>
    </head>
    
    <body>
        <script type="text/javascript">
            var scr_width = 640;
            var scr_height = 960;
            var game = new Phaser.Game(scr_width, scr_height, Phaser.AUTO, '', { preload: preload, create: create, update: update });
            var map;
            
            var layer_bg;
            var hud_top;
            var hud_bottom;
            
           var start_x = null;  
           var start_y = null;  
           
            var graphics;
            
            var sizer_rect; // Temporary variable for defining collision zones
            
            function preload(){
                game.load.image('bg', 'assets/imgs/default/bg.png');
                game.load.image('hud_top', 'assets/imgs/default/hud/top.png');
                game.load.image('hud_bot', 'assets/imgs/default/hud/bottom.png');
                game.load.atlasJSONHash('tiles_atlas', 'assets/imgs/default/tiles.png', 'assets/imgs/default/tiles.json');
                
                game.load.tilemap("map", "assets/imgs/default/map.json", null, Phaser.Tilemap.TILED_JSON);
                game.load.image("tiles_img", "assets/imgs/default/tiles.png");
//game.load.image("Tiles", "castle_0.png");
            }
            
            function create() {
               mouse_start_x = null;  
               mouse_start_y = null;  
           
               graphics = game.add.graphics(0, 0);
               graphics.beginFill(0x839353, 1);
               graphics.drawRect(0, 0, scr_width, scr_height);
               graphics.endFill();
              
               map = game.add.tilemap("map", 32, 32, 20, 20);
               map.addTilesetImage("tiles", "tiles_img");

               bg_map_layer = map.createLayer("Background")//.resizeWorld();
               bg_map_layer.y = 200;
               
               hud_top = game.add.sprite(0, 0, 'hud_top');
               hud_bot = game.add.sprite(0, 0, 'hud_bot');
               hud_bot.y = scr_height - hud_bot.height;
               
               //var cloud_a = game.add.sprite(100, 100, 'tiles_atlas', 'Cloud/Cloud_A.png');
               
               // TODO: Replace this with a real tilemap
//               for(var i = 0; i < 20; i++){
//                   for(var j = 0; j < 20; j++){
//                       bg1 = game.add.sprite((i*32), 100 + (j*32), 'bg');
//                   }
//               }
               
               
//                game.stage.backgroundColor = '#FF0000'
//                
//                // Setup the background tile layer
//                map = game.add.tilemap('playfield');
//                map.addTilesetImage('playfield', 'bg');
//                
                //layer_bg = map.create('playfield', 20, 20, 32, 32);
            }
           
           function update(){
//                if(game.input.mousePointer.isDown){
//                    if(start_x === null){
//                       start_x = game.input.mousePointer.x;
//                       start_y = game.input.mousePointer.y;
//                    }
//                    
//                    var width  = start_x - game.input.mousePointer.x;
//                    var height = start_y - game.input.mousePointer.y;
//                    
//                    graphics.beginFill(0x00FF00, 1);
//                    graphics.drawRect(start_x, start_y, width, height);
//                    graphics.endFill();
//                    
//                }else{
//                    graphics.clear();
//                }
            }
            
        </script>
    </body>
</html>